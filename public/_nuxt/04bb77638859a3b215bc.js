(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{778:function(e,t,n){"use strict";e.exports=n(151)||!n(62)((function(){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete n(54)[e]}))},779:function(e,t,n){"use strict";var r=n(53),o=n(97),c=n(127),l=n(72);n(68)&&r(r.P+n(778),"Object",{__defineGetter__:function(e,t){l.f(o(this),e,{get:c(t),enumerable:!0,configurable:!0})}})},787:function(e,t,n){},796:function(e,t,n){"use strict";var r=n(787);n.n(r).a},808:function(e,t,n){"use strict";n.r(t);n(116);var r=n(51),o=n(4),c=n(794),view=n(780),l={components:{BIconFilePlus:o.We,PostCreate:c.a,PostIndex:view.a},middleware:"authenticated",head:function(){return{title:"My Posts"}},data:function(){return{posts:[],showCreate:!1,errors:null,complete:!1,loading:!1}},beforeRouteLeave:function(e,t,n){return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Echo.leave("post.".concat($nuxt.user.id));case 2:return e.next=4,Echo.leave("postsUpdated");case 4:n();case 5:case"end":return e.stop()}}),e)})))()},created:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getPosts();case 2:Echo.private("post.".concat($nuxt.user.id)).listen("PostOwner",(function(t){e.posts.unshift(t.post)})),Echo.join("postsUpdated").listen("LikePost",(function(t){var n=[];e.posts.forEach((function(e){e.id==t.post.id?n.push(t.post):n.push(e)})),e.posts=n})).listen("CommentAdded",(function(t){var n=[];e.posts.forEach((function(e){e.id==t.post.id?n.push(t.post):n.push(e)})),e.posts=n}));case 4:case"end":return t.stop()}}),t)})))()},methods:{open:function(){this.showCreate=!0,this.complete=!1},handleCancel:function(){this.showCreate=!1,this.complete=!0},handeOk:function(data){var e=this;this.loading=!0,this.$nuxt.$refs.loading.start(),axios.post("/posts",data).then((function(t){e.loading=!1,e.showCreate=!1,e.complete=!0,e.errors=null,e.$message.success(t.data.message),e.$nuxt.$refs.loading.finish()})).catch((function(t){e.loading=!1,e.$nuxt.$refs.loading.finish(),t.response?422==t.response.status?(e.errors=t.response.data.errors,e.$message.error(t.response.data.message)):401==t.response.status&&($nuxt.user=null,e.$message.error(t.response.data.message),e.$router.push({path:"/login"})):e.$message.error("no internet")}))},getPosts:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.$nuxt.$refs.loading.start(),axios.get("/posts").then((function(t){e.$nuxt.$refs.loading.finish(),e.posts=t.data})).catch((function(t){e.$nuxt.$refs.loading.finish(),t.response?401==t.response.status?($nuxt.user=null,e.$router.push({path:"/login"}),e.$message.error(t.response.data.message)):429==t.response.status&&(e.$router.push({path:"/login"}),e.$message.error(t.response.data.message)):e.getPosts()}));case 2:case"end":return t.stop()}}),t)})))()}}},d=(n(796),n(86)),component=Object(d.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",{attrs:{role:"main"}},[n("PostCreate",{attrs:{errors:e.errors,show:e.showCreate,complete:e.complete,loading:e.loading},on:{handeOk:e.handeOk,handleCancel:e.handleCancel}}),e._v(" "),n("section",{staticClass:"jumbotron text-center"},[n("div",{staticClass:"container"},[n("h1",{staticClass:"animate__fadeInDown"},[e._v("My Posts")]),e._v(" "),n("p",[n("button",{staticClass:"btn btn-primary",on:{click:e.open}},[e._v("\n          Create post\n          "),n("b-icon-file-plus")],1)])])]),e._v(" "),e.posts.length>0?n("div",{staticClass:"album py-5"},[n("div",{staticClass:"container"},e._l(e.posts,(function(e,t){return n("post-index",{key:t,attrs:{post:e}})})),1)]):e._e()],1)}),[],!1,null,"445c3393",null);t.default=component.exports}}]);